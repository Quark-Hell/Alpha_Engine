include(FetchContent)
include(CMakeVariables.txt)

if(INSTALL_DEPENDENCIES)

    if(UNIX AND NOT APPLE)

        FetchContent_Declare(Dependencies
          GIT_REPOSITORY "https://github.com/Quark-Hell/Alpha_Engine_Dependencies.git"
          GIT_TAG "origin/Linux"
          GIT_PROGRESS   TRUE
          GIT_SHALLOW    TRUE
          SOURCE_DIR "${CMAKE_BINARY_DIR}/external"
        )
        FetchContent_MakeAvailable(Dependencies)

        execute_process (
            COMMAND ${CMAKE_COMMAND} -E copy_if_different
            "${CMAKE_BINARY_DIR}/external/libassimp.so.5"
            "${Engine}/lib/libassimp.so.5"

            COMMAND ${CMAKE_COMMAND} -E copy_if_different
            "${CMAKE_BINARY_DIR}/external/glfw3.a"
            "${Engine}/lib/glfw3.a"
        )

    elseif(WIN32)

        if(MSVC)

            FetchContent_Declare(Dependencies
              GIT_REPOSITORY "https://github.com/Quark-Hell/Alpha_Engine_Dependencies.git"
              GIT_TAG "origin/Windows10_MSVC"
              GIT_PROGRESS   TRUE
              GIT_SHALLOW    TRUE
              SOURCE_DIR "${CMAKE_BINARY_DIR}/external"
            )
            FetchContent_MakeAvailable(Dependencies)

            execute_process (
                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/assimp.dll"
                "${Engine}/lib/assimp.dll"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/assimp.lib"
                "${Engine}/lib/assimp.lib"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/glew32s.lib"
                "${Engine}/lib/glew32s.lib"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/glfw3.lib"
                "${Engine}/lib/glfw3.lib"
            )

        elseif(MINGW)

            FetchContent_Declare(Dependencies
              GIT_REPOSITORY "https://github.com/Quark-Hell/Alpha_Engine_Dependencies.git"
              GIT_TAG "origin/Windows10_MINGW"
              GIT_PROGRESS   TRUE
              GIT_SHALLOW    TRUE
              SOURCE_DIR "${CMAKE_BINARY_DIR}/external"
            )
            FetchContent_MakeAvailable(Dependencies)

            execute_process (
                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/assimp.dll.a"
                "${Engine}/lib/assimp.dll.a"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/libassimp-5.dll"
                "${Engine}/lib/libassimp-5.dll"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/glew32.dll.a"
                "${Engine}/lib/glew32.dll.a"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/glew32.dll"
                "${Engine}/lib/glew32.dll"

                COMMAND ${CMAKE_COMMAND} -E copy_if_different
                "${CMAKE_BINARY_DIR}/external/glfw3.a"
                "${Engine}/lib/glfw3.a"
            )

        endif()

    else()
        message( FATAL_ERROR "Unsupported system. Now supported: \ 
        Linux; \
        Windows with MSVC Compiler; \
        Windows with MinGW Compiler" )
    endif()

endif()
